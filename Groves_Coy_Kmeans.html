<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="AGroves">

<title>Groves_Coy_Kmeans</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Groves_Coy_Kmeans_files/libs/clipboard/clipboard.min.js"></script>
<script src="Groves_Coy_Kmeans_files/libs/quarto-html/quarto.js"></script>
<script src="Groves_Coy_Kmeans_files/libs/quarto-html/popper.min.js"></script>
<script src="Groves_Coy_Kmeans_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Groves_Coy_Kmeans_files/libs/quarto-html/anchor.min.js"></script>
<link href="Groves_Coy_Kmeans_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Groves_Coy_Kmeans_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Groves_Coy_Kmeans_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Groves_Coy_Kmeans_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Groves_Coy_Kmeans_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Groves_Coy_Kmeans</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>AGroves </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="load-packages" class="level2">
<h2 class="anchored" data-anchor-id="load-packages">Load Packages</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("rmarkdown")</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("adehabitatHR")</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("plyr")</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("dplyr")</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("terra")</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("sf")</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("ggplot2")</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("ggpubr")</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("spatstat")</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("cluster")</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("purrr")</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("lubridate")</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("raster")</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(adehabitatHR)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: sp</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: ade4</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: adehabitatMA</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Registered S3 methods overwritten by 'adehabitatMA':
  method                       from
  print.SpatialPixelsDataFrame sp  
  print.SpatialPixels          sp  </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: adehabitatLT</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: CircStats</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: MASS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: boot</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'plyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:adehabitatLT':

    id</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:adehabitatMA':

    join</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:plyr':

    arrange, count, desc, failwith, id, mutate, rename, summarise,
    summarize</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:adehabitatLT':

    id</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:MASS':

    select</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(terra)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>terra 1.8.42</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'terra'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:MASS':

    area</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:adehabitatMA':

    buffer</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Linking to GEOS 3.13.1, GDAL 3.10.2, PROJ 9.5.1; sf_use_s2() is TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'ggpubr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:terra':

    rotate</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:plyr':

    mutate</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(spatstat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: spatstat.data</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: spatstat.univar</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>spatstat.univar 3.1-2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: spatstat.geom</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>spatstat.geom 3.3-6</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'spatstat.geom'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:ggpubr':

    border, rotate</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:terra':

    area, delaunay, is.empty, rescale, rotate, shift, where.max,
    where.min</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:MASS':

    area</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:ade4':

    disc</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: spatstat.random</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>spatstat.random 3.3-3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: spatstat.explore</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: nlme</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'nlme'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    collapse</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>spatstat.explore 3.4-2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'spatstat.explore'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:boot':

    envelope</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: spatstat.model</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: rpart</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>spatstat.model 3.3-5</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: spatstat.linnet</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>spatstat.linnet 3.2-5</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
spatstat 3.3-2 
For an introduction to spatstat, type 'beginner' </code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cluster) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'cluster'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:spatstat.geom':

    volume</code></pre>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(purrr) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'purrr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:plyr':

    compact</code></pre>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'lubridate'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:terra':

    intersect, union</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    date, intersect, setdiff, union</code></pre>
</div>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(raster)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'raster'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:nlme':

    getData</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    select</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:MASS':

    select</code></pre>
</div>
</div>
</section>
<section id="import-data" class="level2">
<h2 class="anchored" data-anchor-id="import-data">Import Data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Automatically set working directory to the script's location</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a><span class="do">##THIS PART BUGS OUT IN RENDER IF NOT COMMENTED OUT, WILL BE UNCOMMENTED IN NORMAL CODE</span></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a><span class="co">#if (requireNamespace("rstudioapi", quietly = TRUE)) {</span></span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a> <span class="co"># current_path &lt;- rstudioapi::getActiveDocumentContext()$path</span></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">#if (nzchar(current_path)) {</span></span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>   <span class="co"># setwd(dirname(current_path))</span></span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>  <span class="co">#}</span></span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a><span class="co">#}</span></span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"C:/Users/Aaron Groves/Documents/_GradSchool/_PCDump_GradSchool/HomeWork/Kmean/Final Code/kmeans_Master.RData"</span>)</span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-14"><a href="#cb73-14" aria-hidden="true" tabindex="-1"></a><span class="co">#Import sample list</span></span>
<span id="cb73-15"><a href="#cb73-15" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"kmeans_Master.RData"</span>)</span>
<span id="cb73-16"><a href="#cb73-16" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(master.fdeploy.list[[<span class="dv">1</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          ID Device.Name Device.ID   Date...Time..GMT. Date...Time..Local.
1398 B1035oe     B1035oe     84648 2019-12-17 12:01:11 2019-12-17 07:01:11
1399 B1035oe     B1035oe     84648 2019-12-18 04:00:35 2019-12-17 23:00:35
1400 B1035oe     B1035oe     84648 2019-12-18 12:01:09 2019-12-18 07:01:09
1401 B1035oe     B1035oe     84648 2019-12-18 16:01:09 2019-12-18 11:01:09
1402 B1035oe     B1035oe     84648 2019-12-18 20:00:33 2019-12-18 15:00:33
1403 B1035oe     B1035oe     84648 2019-12-19 00:00:36 2019-12-18 19:00:36
     Latitude Longitude Altitude                  Fix.Status DOP Temp..C.
1398 43.42300 -90.33612    -0.30 2-D least-squares   (3 SVs) 3.2      0.0
1399 43.41643 -90.33066   233.07 4 or more SV KF     (7 SVs) 1.2      0.0
1400 43.41011 -90.33466   263.04 4 or more SV KF     (4 SVs) 3.6     -5.0
1401 43.41306 -90.33211    -0.14 2-D least-squares   (3 SVs) 6.4      0.5
1402 43.40887 -90.33090   255.02 3-D least-squares   (5 SVs) 3.0      6.5
1403 43.40062 -90.32518   321.10 4 or more SV KF     (6 SVs) 1.6     -3.5
     Main..V. Back..V.           rdate.gmt          rdate.cent      F.ID
1398        0        0 2019-12-17 12:01:00 2019-12-17 06:01:00 B1035oe_1
1399        0        0 2019-12-18 04:00:00 2019-12-17 22:00:00 B1035oe_2
1400        0        0 2019-12-18 12:01:00 2019-12-18 06:01:00 B1035oe_3
1401        0        0 2019-12-18 16:01:00 2019-12-18 10:01:00 B1035oe_4
1402        0        0 2019-12-18 20:00:00 2019-12-18 14:00:00 B1035oe_5
1403        0        0 2019-12-19 00:00:00 2019-12-18 18:00:00 B1035oe_6
              start_date               year1               year2
1398 2019-12-17 06:01:00 2020-12-16 06:01:00 2021-12-16 06:01:00
1399 2019-12-17 06:01:00 2020-12-16 06:01:00 2021-12-16 06:01:00
1400 2019-12-17 06:01:00 2020-12-16 06:01:00 2021-12-16 06:01:00
1401 2019-12-17 06:01:00 2020-12-16 06:01:00 2021-12-16 06:01:00
1402 2019-12-17 06:01:00 2020-12-16 06:01:00 2021-12-16 06:01:00
1403 2019-12-17 06:01:00 2020-12-16 06:01:00 2021-12-16 06:01:00
                   year3       year.ID
1398 2022-12-16 06:01:00 year1.B1035oe
1399 2022-12-16 06:01:00 year1.B1035oe
1400 2022-12-16 06:01:00 year1.B1035oe
1401 2022-12-16 06:01:00 year1.B1035oe
1402 2022-12-16 06:01:00 year1.B1035oe
1403 2022-12-16 06:01:00 year1.B1035oe</code></pre>
</div>
</div>
<section id="data-formatting" class="level3">
<h3 class="anchored" data-anchor-id="data-formatting">Data Formatting</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to single dataframe</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>coy.df <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, master.fdeploy.list)</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Format date column as POSIXct</span></span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>coy.df<span class="sc">$</span>rdate.cent <span class="ot">&lt;-</span> <span class="fu">as.POSIXct</span>(coy.df<span class="sc">$</span>rdate.cent, <span class="at">format =</span> <span class="st">"%Y-%m-%d %H:%M:%S"</span>, <span class="at">tz =</span> <span class="st">"America/Chicago"</span>)</span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert data frame to an sf object</span></span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a>coy.df <span class="ot">&lt;-</span> coy.df[<span class="sc">!</span>(<span class="fu">is.na</span>(coy.df<span class="sc">$</span>Lat) <span class="sc">|</span> <span class="fu">is.na</span>(coy.df<span class="sc">$</span>Long)), ]</span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a>temp.utm1 <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(coy.df, <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"Longitude"</span>, <span class="st">"Latitude"</span>), <span class="at">crs =</span> <span class="dv">4326</span>)</span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-14"><a href="#cb75-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Transform to UTM</span></span>
<span id="cb75-15"><a href="#cb75-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-16"><a href="#cb75-16" aria-hidden="true" tabindex="-1"></a>temp.utm2 <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(temp.utm1, <span class="at">crs =</span> <span class="dv">32615</span>)</span>
<span id="cb75-17"><a href="#cb75-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-18"><a href="#cb75-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract UTM x and y as numeric columns</span></span>
<span id="cb75-19"><a href="#cb75-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-20"><a href="#cb75-20" aria-hidden="true" tabindex="-1"></a>utm_coords <span class="ot">&lt;-</span> <span class="fu">st_coordinates</span>(temp.utm2)</span>
<span id="cb75-21"><a href="#cb75-21" aria-hidden="true" tabindex="-1"></a>coy.df<span class="sc">$</span>x <span class="ot">&lt;-</span> utm_coords[, <span class="st">"X"</span>]</span>
<span id="cb75-22"><a href="#cb75-22" aria-hidden="true" tabindex="-1"></a>coy.df<span class="sc">$</span>y <span class="ot">&lt;-</span> utm_coords[, <span class="st">"Y"</span>]</span>
<span id="cb75-23"><a href="#cb75-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-24"><a href="#cb75-24" aria-hidden="true" tabindex="-1"></a>coy.dat <span class="ot">&lt;-</span> coy.df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="creation-of-functions-to-be-used-in-for-loop" class="level2">
<h2 class="anchored" data-anchor-id="creation-of-functions-to-be-used-in-for-loop">Creation of Functions to be used in For Loop</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Silhouette method for determining number of clusters in k-means clustering</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>avg_sil <span class="ot">&lt;-</span> <span class="cf">function</span>(k) {</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>  km.res <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(input, <span class="at">centers =</span> k, <span class="at">nstart =</span> <span class="dv">25</span>)</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>  ss <span class="ot">&lt;-</span> <span class="fu">silhouette</span>(km.res<span class="sc">$</span>cluster, <span class="fu">dist</span>(input))</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(ss[, <span class="dv">3</span>])</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>transform.clust <span class="ot">&lt;-</span> <span class="cf">function</span>(key, old.ids){</span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a>  key.df <span class="ot">&lt;-</span> key[,<span class="fu">c</span>(<span class="st">"old.clust.id"</span>, <span class="st">"new.id"</span>)]</span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a>  key.df <span class="ot">&lt;-</span> key.df[<span class="fu">duplicated</span>(key.df)<span class="sc">==</span>F,]</span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a>  new.ids <span class="ot">&lt;-</span> old.ids</span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(key.df)){</span>
<span id="cb76-13"><a href="#cb76-13" aria-hidden="true" tabindex="-1"></a>    new.ids[old.ids<span class="sc">==</span>key.df<span class="sc">$</span>old.clust.id[j]] <span class="ot">&lt;-</span> key.df<span class="sc">$</span>new.id[j]</span>
<span id="cb76-14"><a href="#cb76-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb76-15"><a href="#cb76-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(new.ids)</span>
<span id="cb76-16"><a href="#cb76-16" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="final-formattingprep" class="level2">
<h2 class="anchored" data-anchor-id="final-formattingprep">Final Formatting/Prep</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert movement data to adehabitatLT ltraj object</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>traj <span class="ot">&lt;-</span> <span class="fu">as.ltraj</span>(coy.dat[,<span class="fu">c</span>(<span class="st">"x"</span>, <span class="st">"y"</span>)], <span class="at">date =</span> coy.dat<span class="sc">$</span>rdate.cent, <span class="at">id =</span> coy.dat<span class="sc">$</span>year.ID)</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(traj)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
*********** List of class ltraj ***********

Type of the traject: Type II (time recorded)
* Time zone: America/Chicago *
Irregular traject. Variable time lag between two locs

Characteristics of the bursts:
             id         burst nb.reloc NAs          date.begin
1 year1.B1035oe year1.B1035oe     1422   0 2019-12-17 06:01:00
2 year1.B1044be year1.B1044be     1300   0 2017-11-20 22:01:00
3 year1.B1064yw year1.B1064yw     1582   0 2020-02-08 18:00:00
4 year1.B1065yw year1.B1065yw     1124   0 2020-01-07 14:00:00
5 year1.B1066yw year1.B1066yw     1202   0 2020-02-26 14:01:00
6 year1.B1068yw year1.B1068yw     1649   0 2019-11-19 14:00:00
             date.end
1 2020-12-16 02:00:00
2 2018-11-20 18:00:00
3 2021-02-07 18:00:00
4 2021-01-06 14:00:00
5 2021-02-24 22:00:00
6 2020-11-18 10:01:00


 infolocs provided. The following variables are available:
[1] "pkey"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create empty df for output data</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>full.out <span class="ot">&lt;-</span> <span class="cn">NULL</span> </span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Mini/Max number of clusters to optimize from in kmeans clustering</span></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>k.values <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="k-means-for-loop" class="level2">
<h2 class="anchored" data-anchor-id="k-means-for-loop">K-means For Loop</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(traj)){</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(i)</span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># to be safe, null out udoi at the start of each loop</span></span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>  udoi <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Name based on ID for naming files/maps</span></span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a>  temp.name <span class="ot">&lt;-</span> <span class="fu">attr</span>(traj[[i]], <span class="st">"id"</span>)</span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a>  <span class="do">#### k-means clustering of (x,y) locations ####</span></span>
<span id="cb80-12"><a href="#cb80-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-13"><a href="#cb80-13" aria-hidden="true" tabindex="-1"></a>  coy1_utm <span class="ot">&lt;-</span> traj[[i]][,<span class="fu">c</span>(<span class="st">"x"</span>, <span class="st">"y"</span>)]</span>
<span id="cb80-14"><a href="#cb80-14" aria-hidden="true" tabindex="-1"></a>  input <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">coordinates</span>(coy1_utm)[,<span class="dv">1</span>], <span class="at">y =</span> <span class="fu">coordinates</span>(coy1_utm)[,<span class="dv">2</span>])</span>
<span id="cb80-15"><a href="#cb80-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-16"><a href="#cb80-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-17"><a href="#cb80-17" aria-hidden="true" tabindex="-1"></a>  <span class="do">### Determining number of clusters to evaluate </span><span class="al">###</span></span>
<span id="cb80-18"><a href="#cb80-18" aria-hidden="true" tabindex="-1"></a>  avg_sil_values <span class="ot">&lt;-</span> <span class="fu">map_dbl</span>(k.values, avg_sil)</span>
<span id="cb80-19"><a href="#cb80-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-20"><a href="#cb80-20" aria-hidden="true" tabindex="-1"></a>  <span class="co">#K values = numbner of klusters, avg_sil is function </span></span>
<span id="cb80-21"><a href="#cb80-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-22"><a href="#cb80-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># extract optimal number of clusters</span></span>
<span id="cb80-23"><a href="#cb80-23" aria-hidden="true" tabindex="-1"></a>  snc <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">k.values =</span> k.values,</span>
<span id="cb80-24"><a href="#cb80-24" aria-hidden="true" tabindex="-1"></a>                    <span class="at">sil =</span> avg_sil_values)</span>
<span id="cb80-25"><a href="#cb80-25" aria-hidden="true" tabindex="-1"></a>  nc <span class="ot">&lt;-</span> snc<span class="sc">$</span>k.values[snc<span class="sc">$</span>sil<span class="sc">==</span><span class="fu">max</span>(snc<span class="sc">$</span>sil)] <span class="do">#### number of clusts OUT</span></span>
<span id="cb80-26"><a href="#cb80-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-27"><a href="#cb80-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-28"><a href="#cb80-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add date to coy1_utm</span></span>
<span id="cb80-29"><a href="#cb80-29" aria-hidden="true" tabindex="-1"></a>  coy1_utm<span class="sc">$</span>date <span class="ot">&lt;-</span> traj[[i]][,<span class="fu">c</span>(<span class="st">"date"</span>)]</span>
<span id="cb80-30"><a href="#cb80-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-31"><a href="#cb80-31" aria-hidden="true" tabindex="-1"></a>  <span class="do">### run kmeans clustering </span><span class="al">###</span></span>
<span id="cb80-32"><a href="#cb80-32" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(input, <span class="at">centers=</span>nc, <span class="at">nstart =</span> <span class="dv">25</span>) <span class="do">#### RUNS K mneas with # clust</span></span>
<span id="cb80-33"><a href="#cb80-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-34"><a href="#cb80-34" aria-hidden="true" tabindex="-1"></a>  input<span class="sc">$</span>cluster <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(out<span class="sc">$</span>cluster)</span>
<span id="cb80-35"><a href="#cb80-35" aria-hidden="true" tabindex="-1"></a>  centers <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x=</span>out<span class="sc">$</span>centers[,<span class="fu">c</span>(<span class="st">"x"</span>)], <span class="at">y =</span>out<span class="sc">$</span>centers[,<span class="fu">c</span>(<span class="st">"y"</span>)], <span class="at">cluster =</span> <span class="fu">row.names</span>(out<span class="sc">$</span>centers))</span>
<span id="cb80-36"><a href="#cb80-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-37"><a href="#cb80-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-38"><a href="#cb80-38" aria-hidden="true" tabindex="-1"></a>  input<span class="sc">$</span>time <span class="ot">&lt;-</span> coy1_utm<span class="sc">$</span>date</span>
<span id="cb80-39"><a href="#cb80-39" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-40"><a href="#cb80-40" aria-hidden="true" tabindex="-1"></a>  <span class="do">#### extract sequence of use of clusters ####</span></span>
<span id="cb80-41"><a href="#cb80-41" aria-hidden="true" tabindex="-1"></a>  use.seq <span class="ot">&lt;-</span> input</span>
<span id="cb80-42"><a href="#cb80-42" aria-hidden="true" tabindex="-1"></a>  use.seq<span class="sc">$</span>cdiff <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="fu">diff</span>(use.seq<span class="sc">$</span>cluster)) <span class="co"># any non-zero is a cluster-use "switch"</span></span>
<span id="cb80-43"><a href="#cb80-43" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-44"><a href="#cb80-44" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-45"><a href="#cb80-45" aria-hidden="true" tabindex="-1"></a>  <span class="co"># get time intervals based on when switching occurs</span></span>
<span id="cb80-46"><a href="#cb80-46" aria-hidden="true" tabindex="-1"></a>  switches <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fu">which</span>(use.seq<span class="sc">$</span>cdiff <span class="sc">!=</span> <span class="dv">0</span>), <span class="fu">nrow</span>(use.seq)) </span>
<span id="cb80-47"><a href="#cb80-47" aria-hidden="true" tabindex="-1"></a>  seq.out <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb80-48"><a href="#cb80-48" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-49"><a href="#cb80-49" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(<span class="fu">length</span>(switches)<span class="sc">-</span><span class="dv">1</span>)){</span>
<span id="cb80-50"><a href="#cb80-50" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb80-51"><a href="#cb80-51" aria-hidden="true" tabindex="-1"></a>    start <span class="ot">&lt;-</span> use.seq<span class="sc">$</span>time[switches[j]]</span>
<span id="cb80-52"><a href="#cb80-52" aria-hidden="true" tabindex="-1"></a>    end <span class="ot">&lt;-</span> use.seq<span class="sc">$</span>time[switches[j<span class="sc">+</span><span class="dv">1</span>]<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb80-53"><a href="#cb80-53" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb80-54"><a href="#cb80-54" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(j<span class="sc">==</span>(<span class="fu">length</span>(switches)<span class="sc">-</span><span class="dv">1</span>)){</span>
<span id="cb80-55"><a href="#cb80-55" aria-hidden="true" tabindex="-1"></a>      end <span class="ot">&lt;-</span> <span class="fu">tail</span>(use.seq<span class="sc">$</span>time,<span class="dv">1</span>)</span>
<span id="cb80-56"><a href="#cb80-56" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb80-57"><a href="#cb80-57" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb80-58"><a href="#cb80-58" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Time of cluster use</span></span>
<span id="cb80-59"><a href="#cb80-59" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb80-60"><a href="#cb80-60" aria-hidden="true" tabindex="-1"></a>    temp.int <span class="ot">&lt;-</span> <span class="fu">interval</span>(start, end, <span class="at">tz  =</span> <span class="st">"America/Chicago"</span>)</span>
<span id="cb80-61"><a href="#cb80-61" aria-hidden="true" tabindex="-1"></a>    temp.c <span class="ot">&lt;-</span> use.seq<span class="sc">$</span>cluster[switches[j]]</span>
<span id="cb80-62"><a href="#cb80-62" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb80-63"><a href="#cb80-63" aria-hidden="true" tabindex="-1"></a>    temp.seq.out <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">interval =</span> temp.int,</span>
<span id="cb80-64"><a href="#cb80-64" aria-hidden="true" tabindex="-1"></a>                               <span class="at">old.clust.id =</span> temp.c) <span class="do">####out put##############</span></span>
<span id="cb80-65"><a href="#cb80-65" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb80-66"><a href="#cb80-66" aria-hidden="true" tabindex="-1"></a>    seq.out <span class="ot">&lt;-</span> <span class="fu">rbind</span>(seq.out, temp.seq.out)</span>
<span id="cb80-67"><a href="#cb80-67" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb80-68"><a href="#cb80-68" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-69"><a href="#cb80-69" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-70"><a href="#cb80-70" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Re-name clusters based on sequence of use</span></span>
<span id="cb80-71"><a href="#cb80-71" aria-hidden="true" tabindex="-1"></a>  seq.out<span class="sc">$</span>new.id <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb80-72"><a href="#cb80-72" aria-hidden="true" tabindex="-1"></a>  seq.out<span class="sc">$</span>new.id[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co"># first cluster is always "1"</span></span>
<span id="cb80-73"><a href="#cb80-73" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-74"><a href="#cb80-74" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">nrow</span>(seq.out)){</span>
<span id="cb80-75"><a href="#cb80-75" aria-hidden="true" tabindex="-1"></a>      temp.old <span class="ot">&lt;-</span> seq.out<span class="sc">$</span>old.clust.id[j]</span>
<span id="cb80-76"><a href="#cb80-76" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb80-77"><a href="#cb80-77" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(<span class="fu">duplicated</span>(seq.out<span class="sc">$</span>old.clust.id)[j]<span class="sc">==</span>F){</span>
<span id="cb80-78"><a href="#cb80-78" aria-hidden="true" tabindex="-1"></a>         temp.new <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="fu">na.omit</span>(seq.out<span class="sc">$</span>new.id)) <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb80-79"><a href="#cb80-79" aria-hidden="true" tabindex="-1"></a>      }<span class="cf">else</span>{</span>
<span id="cb80-80"><a href="#cb80-80" aria-hidden="true" tabindex="-1"></a>        temp.new <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">na.omit</span>(seq.out<span class="sc">$</span>new.id[seq.out<span class="sc">$</span>old.clust.id<span class="sc">==</span>temp.old],<span class="dv">1</span>))</span>
<span id="cb80-81"><a href="#cb80-81" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb80-82"><a href="#cb80-82" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb80-83"><a href="#cb80-83" aria-hidden="true" tabindex="-1"></a>      seq.out<span class="sc">$</span>new.id[j] <span class="ot">&lt;-</span> temp.new</span>
<span id="cb80-84"><a href="#cb80-84" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb80-85"><a href="#cb80-85" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-86"><a href="#cb80-86" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Use the new id's in seq.out to update cluster id in "input" and "centers" dataframes</span></span>
<span id="cb80-87"><a href="#cb80-87" aria-hidden="true" tabindex="-1"></a>  input<span class="sc">$</span>new.id <span class="ot">&lt;-</span> <span class="fu">transform.clust</span>(<span class="at">key =</span> seq.out, <span class="at">old.ids =</span> input<span class="sc">$</span>cluster)</span>
<span id="cb80-88"><a href="#cb80-88" aria-hidden="true" tabindex="-1"></a>  centers<span class="sc">$</span>new.id <span class="ot">&lt;-</span> <span class="fu">transform.clust</span>(<span class="at">key =</span> seq.out, <span class="at">old.ids =</span> centers<span class="sc">$</span>cluster)</span>
<span id="cb80-89"><a href="#cb80-89" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-90"><a href="#cb80-90" aria-hidden="true" tabindex="-1"></a>  input<span class="sc">$</span>cluster <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(input<span class="sc">$</span>new.id)</span>
<span id="cb80-91"><a href="#cb80-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-92"><a href="#cb80-92" aria-hidden="true" tabindex="-1"></a>  centers<span class="sc">$</span>cluster <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(centers<span class="sc">$</span>new.id)</span>
<span id="cb80-93"><a href="#cb80-93" aria-hidden="true" tabindex="-1"></a>  centers <span class="ot">&lt;-</span> centers[<span class="fu">order</span>(centers<span class="sc">$</span>cluster),]</span>
<span id="cb80-94"><a href="#cb80-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames</span>(centers) <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">nrow</span>(centers))</span>
<span id="cb80-95"><a href="#cb80-95" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-96"><a href="#cb80-96" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-97"><a href="#cb80-97" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Assemble exportable results for sequence of clusters, duration of use</span></span>
<span id="cb80-98"><a href="#cb80-98" aria-hidden="true" tabindex="-1"></a>  seq.vec <span class="ot">&lt;-</span> <span class="fu">paste</span>(seq.out<span class="sc">$</span>new.id, <span class="at">collapse =</span> <span class="st">"-"</span>)</span>
<span id="cb80-99"><a href="#cb80-99" aria-hidden="true" tabindex="-1"></a>  dur.vec <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">as.duration</span>(seq.out<span class="sc">$</span>interval), <span class="st">"days"</span>)</span>
<span id="cb80-100"><a href="#cb80-100" aria-hidden="true" tabindex="-1"></a>  dur.vec <span class="ot">&lt;-</span> <span class="fu">paste</span>(dur.vec, <span class="at">collapse =</span> <span class="st">"-"</span>)</span>
<span id="cb80-101"><a href="#cb80-101" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-102"><a href="#cb80-102" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-103"><a href="#cb80-103" aria-hidden="true" tabindex="-1"></a>  <span class="do">#### total duration of use for each cluster ####</span></span>
<span id="cb80-104"><a href="#cb80-104" aria-hidden="true" tabindex="-1"></a>  seq.out<span class="sc">$</span>dur.days <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">as.duration</span>(seq.out<span class="sc">$</span>interval), <span class="st">"days"</span>)</span>
<span id="cb80-105"><a href="#cb80-105" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-106"><a href="#cb80-106" aria-hidden="true" tabindex="-1"></a>  total.dur <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="at">nrow =</span> <span class="dv">5</span>, <span class="at">ncol =</span> <span class="dv">2</span>))</span>
<span id="cb80-107"><a href="#cb80-107" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(total.dur) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"cluster.id"</span>, <span class="st">"total.dur.days"</span>)</span>
<span id="cb80-108"><a href="#cb80-108" aria-hidden="true" tabindex="-1"></a>  total.dur<span class="sc">$</span>cluster.id <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">5</span>)</span>
<span id="cb80-109"><a href="#cb80-109" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-110"><a href="#cb80-110" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-111"><a href="#cb80-111" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nc){</span>
<span id="cb80-112"><a href="#cb80-112" aria-hidden="true" tabindex="-1"></a>    temp.dur <span class="ot">&lt;-</span> <span class="fu">sum</span>(seq.out<span class="sc">$</span>dur.days[seq.out<span class="sc">$</span>new.id<span class="sc">==</span>j])</span>
<span id="cb80-113"><a href="#cb80-113" aria-hidden="true" tabindex="-1"></a>    total.dur<span class="sc">$</span>total.dur.days[j] <span class="ot">&lt;-</span> temp.dur</span>
<span id="cb80-114"><a href="#cb80-114" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb80-115"><a href="#cb80-115" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb80-116"><a href="#cb80-116" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-117"><a href="#cb80-117" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-118"><a href="#cb80-118" aria-hidden="true" tabindex="-1"></a>  <span class="do">#### estimate home range vertices for identified clusters ####</span></span>
<span id="cb80-119"><a href="#cb80-119" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-120"><a href="#cb80-120" aria-hidden="true" tabindex="-1"></a>  <span class="co"># make sure at least 30 locations for clusters used to estimate HRs</span></span>
<span id="cb80-121"><a href="#cb80-121" aria-hidden="true" tabindex="-1"></a>  c.v <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb80-122"><a href="#cb80-122" aria-hidden="true" tabindex="-1"></a>  hr.input <span class="ot">&lt;-</span> input</span>
<span id="cb80-123"><a href="#cb80-123" aria-hidden="true" tabindex="-1"></a>  coverage <span class="ot">&lt;-</span> <span class="fu">ddply</span>(hr.input, .(cluster), <span class="cf">function</span>(x) <span class="fu">nrow</span>(x))</span>
<span id="cb80-124"><a href="#cb80-124" aria-hidden="true" tabindex="-1"></a>  hr.input <span class="ot">&lt;-</span> hr.input[hr.input<span class="sc">$</span>cluster <span class="sc">%in%</span> coverage<span class="sc">$</span>cluster[coverage<span class="sc">$</span>V1<span class="sc">&gt;=</span><span class="dv">30</span>],]</span>
<span id="cb80-125"><a href="#cb80-125" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-126"><a href="#cb80-126" aria-hidden="true" tabindex="-1"></a>  c.ud <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb80-127"><a href="#cb80-127" aria-hidden="true" tabindex="-1"></a>  c.loc <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> hr.input<span class="sc">$</span>x, <span class="at">y =</span> hr.input<span class="sc">$</span>y)</span>
<span id="cb80-128"><a href="#cb80-128" aria-hidden="true" tabindex="-1"></a>  c.sp <span class="ot">&lt;-</span> <span class="fu">SpatialPointsDataFrame</span>(c.loc, <span class="fu">data.frame</span>(<span class="at">id =</span> <span class="fu">droplevels</span>(<span class="fu">as.factor</span>(hr.input<span class="sc">$</span>cluster))))</span>
<span id="cb80-129"><a href="#cb80-129" aria-hidden="true" tabindex="-1"></a>  c.ud <span class="ot">&lt;-</span> <span class="fu">kernelUD</span>(c.sp, <span class="at">h =</span> <span class="st">"href"</span>, <span class="at">grid =</span> <span class="dv">200</span>)</span>
<span id="cb80-130"><a href="#cb80-130" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-131"><a href="#cb80-131" aria-hidden="true" tabindex="-1"></a>  <span class="fu">try</span>(c.v <span class="ot">&lt;-</span> <span class="fu">getverticeshr</span>(c.ud, <span class="at">percent =</span> <span class="dv">95</span>, <span class="at">unin =</span> <span class="st">"m"</span>, <span class="at">unout =</span> <span class="st">"km2"</span>), <span class="at">silent =</span> T)</span>
<span id="cb80-132"><a href="#cb80-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-133"><a href="#cb80-133" aria-hidden="true" tabindex="-1"></a>    <span class="co"># sometimes the kernel isn't well estimated with defaults; if so, can try increasing the extent or dropping a cluster with minimal coverage (i.e. very few points)</span></span>
<span id="cb80-134"><a href="#cb80-134" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-135"><a href="#cb80-135" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">is.null</span>(c.v)){</span>
<span id="cb80-136"><a href="#cb80-136" aria-hidden="true" tabindex="-1"></a>    <span class="cf">repeat</span>{</span>
<span id="cb80-137"><a href="#cb80-137" aria-hidden="true" tabindex="-1"></a>      <span class="co"># first, try increasing extent</span></span>
<span id="cb80-138"><a href="#cb80-138" aria-hidden="true" tabindex="-1"></a>      c.ud <span class="ot">&lt;-</span> <span class="fu">kernelUD</span>(c.sp, <span class="at">h =</span> <span class="st">"href"</span>, <span class="at">extent =</span> <span class="dv">2</span>)</span>
<span id="cb80-139"><a href="#cb80-139" aria-hidden="true" tabindex="-1"></a>      <span class="fu">try</span>(c.v <span class="ot">&lt;-</span> <span class="fu">getverticeshr</span>(c.ud, <span class="at">percent =</span> <span class="dv">95</span>, <span class="at">unin =</span> <span class="st">"m"</span>, <span class="at">unout =</span> <span class="st">"km2"</span>), <span class="at">silent =</span> T)</span>
<span id="cb80-140"><a href="#cb80-140" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb80-141"><a href="#cb80-141" aria-hidden="true" tabindex="-1"></a>      <span class="co"># if that doesn't work, remove a cluster</span></span>
<span id="cb80-142"><a href="#cb80-142" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(<span class="fu">is.null</span>(c.v)){</span>
<span id="cb80-143"><a href="#cb80-143" aria-hidden="true" tabindex="-1"></a>        coverage2 <span class="ot">&lt;-</span> coverage</span>
<span id="cb80-144"><a href="#cb80-144" aria-hidden="true" tabindex="-1"></a>        coverage2 <span class="ot">&lt;-</span> coverage2[coverage2<span class="sc">$</span>V1<span class="sc">!=</span><span class="fu">min</span>(coverage2<span class="sc">$</span>V1),]</span>
<span id="cb80-145"><a href="#cb80-145" aria-hidden="true" tabindex="-1"></a>        hr.input <span class="ot">&lt;-</span> hr.input[hr.input<span class="sc">$</span>cluster <span class="sc">%in%</span> coverage2<span class="sc">$</span>cluster,]</span>
<span id="cb80-146"><a href="#cb80-146" aria-hidden="true" tabindex="-1"></a>        c.ud <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb80-147"><a href="#cb80-147" aria-hidden="true" tabindex="-1"></a>        c.loc <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> hr.input<span class="sc">$</span>x, <span class="at">y =</span> hr.input<span class="sc">$</span>y)</span>
<span id="cb80-148"><a href="#cb80-148" aria-hidden="true" tabindex="-1"></a>        c.sp <span class="ot">&lt;-</span> <span class="fu">SpatialPointsDataFrame</span>(c.loc, <span class="fu">data.frame</span>(<span class="at">id =</span> <span class="fu">droplevels</span>(<span class="fu">as.factor</span>(hr.input<span class="sc">$</span>cluster))))</span>
<span id="cb80-149"><a href="#cb80-149" aria-hidden="true" tabindex="-1"></a>        c.ud <span class="ot">&lt;-</span> <span class="fu">kernelUD</span>(c.sp, <span class="at">h =</span> <span class="st">"href"</span>)</span>
<span id="cb80-150"><a href="#cb80-150" aria-hidden="true" tabindex="-1"></a>        <span class="fu">try</span>(c.v <span class="ot">&lt;-</span> <span class="fu">getverticeshr</span>(c.ud, <span class="at">percent =</span> <span class="dv">95</span>, <span class="at">unin =</span> <span class="st">"m"</span>, <span class="at">unout =</span> <span class="st">"km2"</span>), <span class="at">silent =</span> T)</span>
<span id="cb80-151"><a href="#cb80-151" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb80-152"><a href="#cb80-152" aria-hidden="true" tabindex="-1"></a>      <span class="co"># if that still doesn't work, repeat and try again</span></span>
<span id="cb80-153"><a href="#cb80-153" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(<span class="fu">is.null</span>(c.v)<span class="sc">==</span>F <span class="sc">|</span> <span class="fu">nrow</span>(coverage2)<span class="sc">==</span><span class="dv">0</span>){</span>
<span id="cb80-154"><a href="#cb80-154" aria-hidden="true" tabindex="-1"></a>        <span class="cf">break</span></span>
<span id="cb80-155"><a href="#cb80-155" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb80-156"><a href="#cb80-156" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb80-157"><a href="#cb80-157" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb80-158"><a href="#cb80-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-159"><a href="#cb80-159" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-160"><a href="#cb80-160" aria-hidden="true" tabindex="-1"></a>  <span class="do">### plot home ranges with original points </span><span class="al">###</span></span>
<span id="cb80-161"><a href="#cb80-161" aria-hidden="true" tabindex="-1"></a>  c.d <span class="ot">&lt;-</span> <span class="fu">suppressMessages</span>(<span class="fu">fortify</span>(c.v))</span>
<span id="cb80-162"><a href="#cb80-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-163"><a href="#cb80-163" aria-hidden="true" tabindex="-1"></a>  <span class="do">#### plot clusters with centroids, use by time ####</span></span>
<span id="cb80-164"><a href="#cb80-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-165"><a href="#cb80-165" aria-hidden="true" tabindex="-1"></a>  p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">data =</span> input, <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y, <span class="at">color=</span>cluster)) <span class="sc">+</span> <span class="fu">geom_path</span>(<span class="at">data =</span> input, <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y), <span class="at">alpha =</span> <span class="fl">0.2</span>)<span class="sc">+</span></span>
<span id="cb80-166"><a href="#cb80-166" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">data =</span> centers, <span class="at">size=</span><span class="dv">10</span>, <span class="at">pch=</span><span class="dv">21</span>,<span class="at">color=</span><span class="st">"black"</span>, <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y, <span class="at">fill =</span> cluster)) <span class="sc">+</span></span>
<span id="cb80-167"><a href="#cb80-167" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#377eb8"</span>, <span class="st">"#4daf4a"</span>, <span class="st">"#984ea3"</span>, <span class="st">"#e41a1c"</span>, <span class="st">"#ff7f00"</span>)) <span class="sc">+</span> </span>
<span id="cb80-168"><a href="#cb80-168" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#377eb8"</span>, <span class="st">"#4daf4a"</span>, <span class="st">"#984ea3"</span>, <span class="st">"#e41a1c"</span>, <span class="st">"#ff7f00"</span>)) <span class="sc">+</span></span>
<span id="cb80-169"><a href="#cb80-169" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_polygon</span>(<span class="at">data =</span> c.d, <span class="fu">aes</span>(<span class="at">x =</span> long, <span class="at">y =</span> lat, <span class="at">group =</span> group, <span class="at">linetype =</span> id), <span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb80-170"><a href="#cb80-170" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(temp.name) <span class="sc">+</span></span>
<span id="cb80-171"><a href="#cb80-171" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span>
<span id="cb80-172"><a href="#cb80-172" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-173"><a href="#cb80-173" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-174"><a href="#cb80-174" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot cluster use by time</span></span>
<span id="cb80-175"><a href="#cb80-175" aria-hidden="true" tabindex="-1"></a>  p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> input, <span class="fu">aes</span>(<span class="at">x=</span>time, <span class="at">color =</span> cluster, <span class="at">fill =</span> cluster)) <span class="sc">+</span> <span class="fu">geom_density</span>(<span class="at">alpha=</span><span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb80-176"><a href="#cb80-176" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#377eb8"</span>, <span class="st">"#4daf4a"</span>, <span class="st">"#984ea3"</span>, <span class="st">"#e41a1c"</span>, <span class="st">"#ff7f00"</span>)) <span class="sc">+</span></span>
<span id="cb80-177"><a href="#cb80-177" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#377eb8"</span>, <span class="st">"#4daf4a"</span>, <span class="st">"#984ea3"</span>, <span class="st">"#e41a1c"</span>, <span class="st">"#ff7f00"</span>)) <span class="sc">+</span></span>
<span id="cb80-178"><a href="#cb80-178" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(temp.name) <span class="sc">+</span></span>
<span id="cb80-179"><a href="#cb80-179" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()</span>
<span id="cb80-180"><a href="#cb80-180" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-181"><a href="#cb80-181" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(p1, p2, <span class="at">nrow =</span> <span class="dv">1</span>)</span>
<span id="cb80-182"><a href="#cb80-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-183"><a href="#cb80-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-184"><a href="#cb80-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-185"><a href="#cb80-185" aria-hidden="true" tabindex="-1"></a>  <span class="do">#### home range/cluster overlap ####</span></span>
<span id="cb80-186"><a href="#cb80-186" aria-hidden="true" tabindex="-1"></a>  o.df <span class="ot">&lt;-</span> p.df <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow =</span> <span class="dv">5</span>, <span class="at">ncol =</span> <span class="dv">5</span>)</span>
<span id="cb80-187"><a href="#cb80-187" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames</span>(p.df) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(p.df) <span class="ot">&lt;-</span> <span class="fu">rownames</span>(o.df) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(o.df) <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">nrow</span>(p.df))</span>
<span id="cb80-188"><a href="#cb80-188" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-189"><a href="#cb80-189" aria-hidden="true" tabindex="-1"></a>  udoi <span class="ot">&lt;-</span> <span class="fu">suppressWarnings</span>(<span class="fu">kerneloverlap</span>(c.sp, <span class="at">method =</span> <span class="st">"UDOI"</span>, <span class="at">percent =</span> <span class="dv">95</span>, <span class="at">grid =</span> <span class="dv">200</span>))</span>
<span id="cb80-190"><a href="#cb80-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-191"><a href="#cb80-191" aria-hidden="true" tabindex="-1"></a>  <span class="co"># if cluster(s) don't produce HR, test if those points are within other HR vertices</span></span>
<span id="cb80-192"><a href="#cb80-192" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-193"><a href="#cb80-193" aria-hidden="true" tabindex="-1"></a>  no.hr.out <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb80-194"><a href="#cb80-194" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-195"><a href="#cb80-195" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">ncol</span>(udoi)<span class="sc">!=</span>nc){</span>
<span id="cb80-196"><a href="#cb80-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-197"><a href="#cb80-197" aria-hidden="true" tabindex="-1"></a>    <span class="co"># indentfying which clusters do not have a enough points</span></span>
<span id="cb80-198"><a href="#cb80-198" aria-hidden="true" tabindex="-1"></a>    no.hr <span class="ot">&lt;-</span> centers<span class="sc">$</span>new.id[<span class="sc">!</span>centers<span class="sc">$</span>new.id <span class="sc">%in%</span> hr.input<span class="sc">$</span>new.id]</span>
<span id="cb80-199"><a href="#cb80-199" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb80-200"><a href="#cb80-200" aria-hidden="true" tabindex="-1"></a>    <span class="co"># loop through clusters without enough points, looping through existing home ranges</span></span>
<span id="cb80-201"><a href="#cb80-201" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(no.hr)){</span>
<span id="cb80-202"><a href="#cb80-202" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb80-203"><a href="#cb80-203" aria-hidden="true" tabindex="-1"></a>      temp.nohr <span class="ot">&lt;-</span> no.hr[k]</span>
<span id="cb80-204"><a href="#cb80-204" aria-hidden="true" tabindex="-1"></a>      temp.nohr.dat <span class="ot">&lt;-</span> input[input<span class="sc">$</span>new.id<span class="sc">==</span>temp.nohr,]</span>
<span id="cb80-205"><a href="#cb80-205" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb80-206"><a href="#cb80-206" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(<span class="fu">unique</span>(c.d<span class="sc">$</span>id))){</span>
<span id="cb80-207"><a href="#cb80-207" aria-hidden="true" tabindex="-1"></a>        temp.bound <span class="ot">&lt;-</span> <span class="fu">owin</span>(<span class="at">poly =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">rev</span>(c.d<span class="sc">$</span>long[c.d<span class="sc">$</span>id<span class="sc">==</span><span class="fu">unique</span>(c.d<span class="sc">$</span>id)[j]]), <span class="at">y =</span> <span class="fu">rev</span>(c.d<span class="sc">$</span>lat[c.d<span class="sc">$</span>id<span class="sc">==</span><span class="fu">unique</span>(c.d<span class="sc">$</span>id)[j]])))</span>
<span id="cb80-208"><a href="#cb80-208" aria-hidden="true" tabindex="-1"></a>        isin1 <span class="ot">&lt;-</span> <span class="fu">inside.owin</span>(<span class="at">x =</span> temp.nohr.dat<span class="sc">$</span>x, <span class="at">y =</span> temp.nohr.dat<span class="sc">$</span>y, <span class="at">w =</span> temp.bound)</span>
<span id="cb80-209"><a href="#cb80-209" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb80-210"><a href="#cb80-210" aria-hidden="true" tabindex="-1"></a>        temp.out <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">hr.id =</span> <span class="fu">unique</span>(c.d<span class="sc">$</span>id)[j],</span>
<span id="cb80-211"><a href="#cb80-211" aria-hidden="true" tabindex="-1"></a>                               <span class="at">nohr.id =</span> temp.nohr,</span>
<span id="cb80-212"><a href="#cb80-212" aria-hidden="true" tabindex="-1"></a>                               <span class="at">isin =</span> <span class="fu">sum</span>(isin1),</span>
<span id="cb80-213"><a href="#cb80-213" aria-hidden="true" tabindex="-1"></a>                               <span class="at">total.points =</span> <span class="fu">nrow</span>(temp.nohr.dat))</span>
<span id="cb80-214"><a href="#cb80-214" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb80-215"><a href="#cb80-215" aria-hidden="true" tabindex="-1"></a>        no.hr.out <span class="ot">&lt;-</span> <span class="fu">rbind</span>(no.hr.out, temp.out)</span>
<span id="cb80-216"><a href="#cb80-216" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb80-217"><a href="#cb80-217" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb80-218"><a href="#cb80-218" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb80-219"><a href="#cb80-219" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-220"><a href="#cb80-220" aria-hidden="true" tabindex="-1"></a>  <span class="co"># extract overlap results for later output</span></span>
<span id="cb80-221"><a href="#cb80-221" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(udoi)){</span>
<span id="cb80-222"><a href="#cb80-222" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(udoi)){</span>
<span id="cb80-223"><a href="#cb80-223" aria-hidden="true" tabindex="-1"></a>      ind1 <span class="ot">&lt;-</span> <span class="fu">rownames</span>(udoi)[j]</span>
<span id="cb80-224"><a href="#cb80-224" aria-hidden="true" tabindex="-1"></a>      ind2 <span class="ot">&lt;-</span> <span class="fu">colnames</span>(udoi)[k]</span>
<span id="cb80-225"><a href="#cb80-225" aria-hidden="true" tabindex="-1"></a>      o.df[ind1, ind2] <span class="ot">&lt;-</span> udoi[j,k]</span>
<span id="cb80-226"><a href="#cb80-226" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb80-227"><a href="#cb80-227" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb80-228"><a href="#cb80-228" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb80-229"><a href="#cb80-229" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-230"><a href="#cb80-230" aria-hidden="true" tabindex="-1"></a>  <span class="co"># extract overlap results for cases where the points cannot produce a HR</span></span>
<span id="cb80-231"><a href="#cb80-231" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">is.null</span>(no.hr.out)<span class="sc">==</span>F){</span>
<span id="cb80-232"><a href="#cb80-232" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(p.df)){</span>
<span id="cb80-233"><a href="#cb80-233" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(p.df)){</span>
<span id="cb80-234"><a href="#cb80-234" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb80-235"><a href="#cb80-235" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(<span class="fu">rownames</span>(p.df)[j] <span class="sc">%in%</span> no.hr.out<span class="sc">$</span>hr.id <span class="sc">&amp;</span> <span class="fu">colnames</span>(p.df)[k] <span class="sc">%in%</span> no.hr.out<span class="sc">$</span>nohr.id){</span>
<span id="cb80-236"><a href="#cb80-236" aria-hidden="true" tabindex="-1"></a>          temp <span class="ot">&lt;-</span> no.hr.out[no.hr.out<span class="sc">$</span>hr.id<span class="sc">==</span><span class="fu">rownames</span>(p.df)[j] <span class="sc">&amp;</span> no.hr.out<span class="sc">$</span>nohr.id<span class="sc">==</span><span class="fu">colnames</span>(p.df)[k],]</span>
<span id="cb80-237"><a href="#cb80-237" aria-hidden="true" tabindex="-1"></a>          p.df[j,k] <span class="ot">&lt;-</span> p.df[k,j] <span class="ot">&lt;-</span> temp<span class="sc">$</span>isin<span class="sc">/</span>temp<span class="sc">$</span>total.points</span>
<span id="cb80-238"><a href="#cb80-238" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb80-239"><a href="#cb80-239" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb80-240"><a href="#cb80-240" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(j<span class="sc">==</span>k <span class="sc">&amp;</span> <span class="fu">colnames</span>(p.df)[k] <span class="sc">%in%</span> no.hr.out<span class="sc">$</span>nohr.id){</span>
<span id="cb80-241"><a href="#cb80-241" aria-hidden="true" tabindex="-1"></a>          p.df[j,k] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co"># assign overlap with self of 1 for screening for ranges with no overlap later</span></span>
<span id="cb80-242"><a href="#cb80-242" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb80-243"><a href="#cb80-243" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb80-244"><a href="#cb80-244" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb80-245"><a href="#cb80-245" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb80-246"><a href="#cb80-246" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb80-247"><a href="#cb80-247" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-248"><a href="#cb80-248" aria-hidden="true" tabindex="-1"></a>  <span class="do">#### estimate distance(s) between cluster centers ####</span></span>
<span id="cb80-249"><a href="#cb80-249" aria-hidden="true" tabindex="-1"></a>  d.df <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow =</span> <span class="dv">5</span>, <span class="at">ncol =</span> <span class="dv">5</span>)</span>
<span id="cb80-250"><a href="#cb80-250" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-251"><a href="#cb80-251" aria-hidden="true" tabindex="-1"></a>  dist.centers <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">dist</span>(centers[,<span class="fu">c</span>(<span class="st">"x"</span>, <span class="st">"y"</span>)], <span class="at">method =</span> <span class="st">"euclidean"</span>)<span class="sc">/</span><span class="dv">1000</span>)</span>
<span id="cb80-252"><a href="#cb80-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-253"><a href="#cb80-253" aria-hidden="true" tabindex="-1"></a>  <span class="co"># extract distance results for output</span></span>
<span id="cb80-254"><a href="#cb80-254" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(dist.centers)){</span>
<span id="cb80-255"><a href="#cb80-255" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(dist.centers)){</span>
<span id="cb80-256"><a href="#cb80-256" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb80-257"><a href="#cb80-257" aria-hidden="true" tabindex="-1"></a>      d.df[j,k] <span class="ot">&lt;-</span> dist.centers[j,k]</span>
<span id="cb80-258"><a href="#cb80-258" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb80-259"><a href="#cb80-259" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb80-260"><a href="#cb80-260" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb80-261"><a href="#cb80-261" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-262"><a href="#cb80-262" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-263"><a href="#cb80-263" aria-hidden="true" tabindex="-1"></a>  <span class="do">#### check if output matrices are all symmetrical ####</span></span>
<span id="cb80-264"><a href="#cb80-264" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">any</span>(<span class="fu">c</span>(<span class="fu">isSymmetric</span>(d.df), <span class="fu">isSymmetric</span>(o.df), <span class="fu">isSymmetric</span>(p.df))<span class="sc">==</span>F)){</span>
<span id="cb80-265"><a href="#cb80-265" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">"assymetric matrices!"</span>)</span>
<span id="cb80-266"><a href="#cb80-266" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb80-267"><a href="#cb80-267" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-268"><a href="#cb80-268" aria-hidden="true" tabindex="-1"></a>  <span class="do">#### ASSEMBLE OUTPUT ####</span></span>
<span id="cb80-269"><a href="#cb80-269" aria-hidden="true" tabindex="-1"></a>  temp.full.out <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">id =</span> <span class="fu">burst</span>(traj[i]),</span>
<span id="cb80-270"><a href="#cb80-270" aria-hidden="true" tabindex="-1"></a>                              <span class="at">nc =</span> <span class="fu">paste</span>(nc),</span>
<span id="cb80-271"><a href="#cb80-271" aria-hidden="true" tabindex="-1"></a>                              </span>
<span id="cb80-272"><a href="#cb80-272" aria-hidden="true" tabindex="-1"></a>                              <span class="co"># location of centers</span></span>
<span id="cb80-273"><a href="#cb80-273" aria-hidden="true" tabindex="-1"></a>                              <span class="at">c1.x =</span> centers<span class="sc">$</span>x[<span class="dv">1</span>],</span>
<span id="cb80-274"><a href="#cb80-274" aria-hidden="true" tabindex="-1"></a>                              <span class="at">c1.y =</span> centers<span class="sc">$</span>y[<span class="dv">1</span>],</span>
<span id="cb80-275"><a href="#cb80-275" aria-hidden="true" tabindex="-1"></a>                              <span class="at">c2.x =</span> centers<span class="sc">$</span>x[<span class="dv">2</span>],</span>
<span id="cb80-276"><a href="#cb80-276" aria-hidden="true" tabindex="-1"></a>                              <span class="at">c2.y =</span> centers<span class="sc">$</span>y[<span class="dv">2</span>],</span>
<span id="cb80-277"><a href="#cb80-277" aria-hidden="true" tabindex="-1"></a>                              <span class="at">c3.x =</span> centers<span class="sc">$</span>x[<span class="dv">3</span>],</span>
<span id="cb80-278"><a href="#cb80-278" aria-hidden="true" tabindex="-1"></a>                              <span class="at">c3.y =</span> centers<span class="sc">$</span>y[<span class="dv">3</span>],</span>
<span id="cb80-279"><a href="#cb80-279" aria-hidden="true" tabindex="-1"></a>                              <span class="at">c4.x =</span> centers<span class="sc">$</span>x[<span class="dv">4</span>],</span>
<span id="cb80-280"><a href="#cb80-280" aria-hidden="true" tabindex="-1"></a>                              <span class="at">c4.y =</span> centers<span class="sc">$</span>y[<span class="dv">4</span>],</span>
<span id="cb80-281"><a href="#cb80-281" aria-hidden="true" tabindex="-1"></a>                              <span class="at">c5.x =</span> centers<span class="sc">$</span>x[<span class="dv">5</span>],</span>
<span id="cb80-282"><a href="#cb80-282" aria-hidden="true" tabindex="-1"></a>                              <span class="at">c5.y =</span> centers<span class="sc">$</span>y[<span class="dv">5</span>],</span>
<span id="cb80-283"><a href="#cb80-283" aria-hidden="true" tabindex="-1"></a>                              </span>
<span id="cb80-284"><a href="#cb80-284" aria-hidden="true" tabindex="-1"></a>                              <span class="co"># distances between centers</span></span>
<span id="cb80-285"><a href="#cb80-285" aria-hidden="true" tabindex="-1"></a>                              <span class="at">dc.km.1_2 =</span> d.df[<span class="dv">1</span>,<span class="dv">2</span>],</span>
<span id="cb80-286"><a href="#cb80-286" aria-hidden="true" tabindex="-1"></a>                              <span class="at">dc.km.1_3 =</span> d.df[<span class="dv">1</span>,<span class="dv">3</span>],</span>
<span id="cb80-287"><a href="#cb80-287" aria-hidden="true" tabindex="-1"></a>                              <span class="at">dc.km.1_4 =</span> d.df[<span class="dv">1</span>,<span class="dv">4</span>],</span>
<span id="cb80-288"><a href="#cb80-288" aria-hidden="true" tabindex="-1"></a>                              <span class="at">dc.km.1_5 =</span> d.df[<span class="dv">1</span>,<span class="dv">5</span>],</span>
<span id="cb80-289"><a href="#cb80-289" aria-hidden="true" tabindex="-1"></a>                              <span class="at">dc.km.2_3 =</span> d.df[<span class="dv">2</span>,<span class="dv">3</span>],</span>
<span id="cb80-290"><a href="#cb80-290" aria-hidden="true" tabindex="-1"></a>                              <span class="at">dc.km.2_4 =</span> d.df[<span class="dv">2</span>,<span class="dv">4</span>],</span>
<span id="cb80-291"><a href="#cb80-291" aria-hidden="true" tabindex="-1"></a>                              <span class="at">dc.km.2_5 =</span> d.df[<span class="dv">2</span>,<span class="dv">5</span>],</span>
<span id="cb80-292"><a href="#cb80-292" aria-hidden="true" tabindex="-1"></a>                              <span class="at">dc.km.3_4 =</span> d.df[<span class="dv">3</span>,<span class="dv">4</span>],</span>
<span id="cb80-293"><a href="#cb80-293" aria-hidden="true" tabindex="-1"></a>                              <span class="at">dc.km.3_5 =</span> d.df[<span class="dv">3</span>,<span class="dv">5</span>],</span>
<span id="cb80-294"><a href="#cb80-294" aria-hidden="true" tabindex="-1"></a>                              <span class="at">dc.km.4_5 =</span> d.df[<span class="dv">4</span>,<span class="dv">5</span>],</span>
<span id="cb80-295"><a href="#cb80-295" aria-hidden="true" tabindex="-1"></a>                              </span>
<span id="cb80-296"><a href="#cb80-296" aria-hidden="true" tabindex="-1"></a>                              <span class="co"># overlap between home ranges</span></span>
<span id="cb80-297"><a href="#cb80-297" aria-hidden="true" tabindex="-1"></a>                              <span class="at">o.1_2 =</span> o.df[<span class="dv">1</span>,<span class="dv">2</span>],</span>
<span id="cb80-298"><a href="#cb80-298" aria-hidden="true" tabindex="-1"></a>                              <span class="at">o.1_3 =</span> o.df[<span class="dv">1</span>,<span class="dv">3</span>],</span>
<span id="cb80-299"><a href="#cb80-299" aria-hidden="true" tabindex="-1"></a>                              <span class="at">o.1_4 =</span> o.df[<span class="dv">1</span>,<span class="dv">4</span>],</span>
<span id="cb80-300"><a href="#cb80-300" aria-hidden="true" tabindex="-1"></a>                              <span class="at">o.1_5 =</span> o.df[<span class="dv">1</span>,<span class="dv">5</span>],</span>
<span id="cb80-301"><a href="#cb80-301" aria-hidden="true" tabindex="-1"></a>                              <span class="at">o.2_3 =</span> o.df[<span class="dv">2</span>,<span class="dv">3</span>],</span>
<span id="cb80-302"><a href="#cb80-302" aria-hidden="true" tabindex="-1"></a>                              <span class="at">o.2_4 =</span> o.df[<span class="dv">2</span>,<span class="dv">4</span>],</span>
<span id="cb80-303"><a href="#cb80-303" aria-hidden="true" tabindex="-1"></a>                              <span class="at">o.2_5 =</span> o.df[<span class="dv">2</span>,<span class="dv">5</span>],</span>
<span id="cb80-304"><a href="#cb80-304" aria-hidden="true" tabindex="-1"></a>                              <span class="at">o.3_4 =</span> o.df[<span class="dv">3</span>,<span class="dv">4</span>],</span>
<span id="cb80-305"><a href="#cb80-305" aria-hidden="true" tabindex="-1"></a>                              <span class="at">o.3_5 =</span> o.df[<span class="dv">3</span>,<span class="dv">5</span>],</span>
<span id="cb80-306"><a href="#cb80-306" aria-hidden="true" tabindex="-1"></a>                              <span class="at">o.4_5 =</span> o.df[<span class="dv">4</span>,<span class="dv">5</span>],</span>
<span id="cb80-307"><a href="#cb80-307" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb80-308"><a href="#cb80-308" aria-hidden="true" tabindex="-1"></a>                              <span class="co"># overlap of points if don't have home range</span></span>
<span id="cb80-309"><a href="#cb80-309" aria-hidden="true" tabindex="-1"></a>                              <span class="at">p.1_2 =</span> p.df[<span class="dv">1</span>,<span class="dv">2</span>],</span>
<span id="cb80-310"><a href="#cb80-310" aria-hidden="true" tabindex="-1"></a>                              <span class="at">p.1_3 =</span> p.df[<span class="dv">1</span>,<span class="dv">3</span>],</span>
<span id="cb80-311"><a href="#cb80-311" aria-hidden="true" tabindex="-1"></a>                              <span class="at">p.1_4 =</span> p.df[<span class="dv">1</span>,<span class="dv">4</span>],</span>
<span id="cb80-312"><a href="#cb80-312" aria-hidden="true" tabindex="-1"></a>                              <span class="at">p.1_5 =</span> p.df[<span class="dv">1</span>,<span class="dv">5</span>],</span>
<span id="cb80-313"><a href="#cb80-313" aria-hidden="true" tabindex="-1"></a>                              <span class="at">p.2_3 =</span> p.df[<span class="dv">2</span>,<span class="dv">3</span>],</span>
<span id="cb80-314"><a href="#cb80-314" aria-hidden="true" tabindex="-1"></a>                              <span class="at">p.2_4 =</span> p.df[<span class="dv">2</span>,<span class="dv">4</span>],</span>
<span id="cb80-315"><a href="#cb80-315" aria-hidden="true" tabindex="-1"></a>                              <span class="at">p.2_5 =</span> p.df[<span class="dv">2</span>,<span class="dv">5</span>],</span>
<span id="cb80-316"><a href="#cb80-316" aria-hidden="true" tabindex="-1"></a>                              <span class="at">p.3_4 =</span> p.df[<span class="dv">3</span>,<span class="dv">4</span>],</span>
<span id="cb80-317"><a href="#cb80-317" aria-hidden="true" tabindex="-1"></a>                              <span class="at">p.3_5 =</span> p.df[<span class="dv">3</span>,<span class="dv">5</span>],</span>
<span id="cb80-318"><a href="#cb80-318" aria-hidden="true" tabindex="-1"></a>                              <span class="at">p.4_5 =</span> p.df[<span class="dv">4</span>,<span class="dv">5</span>],</span>
<span id="cb80-319"><a href="#cb80-319" aria-hidden="true" tabindex="-1"></a>                              </span>
<span id="cb80-320"><a href="#cb80-320" aria-hidden="true" tabindex="-1"></a>                              <span class="co"># duration of use by cluster (total use in days)</span></span>
<span id="cb80-321"><a href="#cb80-321" aria-hidden="true" tabindex="-1"></a>                              <span class="at">dur1.td =</span> total.dur<span class="sc">$</span>total.dur.days[<span class="dv">1</span>],</span>
<span id="cb80-322"><a href="#cb80-322" aria-hidden="true" tabindex="-1"></a>                              <span class="at">dur2.td =</span> total.dur<span class="sc">$</span>total.dur.days[<span class="dv">2</span>],</span>
<span id="cb80-323"><a href="#cb80-323" aria-hidden="true" tabindex="-1"></a>                              <span class="at">dur3.td =</span> total.dur<span class="sc">$</span>total.dur.days[<span class="dv">3</span>],</span>
<span id="cb80-324"><a href="#cb80-324" aria-hidden="true" tabindex="-1"></a>                              <span class="at">dur4.td =</span> total.dur<span class="sc">$</span>total.dur.days[<span class="dv">4</span>],</span>
<span id="cb80-325"><a href="#cb80-325" aria-hidden="true" tabindex="-1"></a>                              <span class="at">dur5.td =</span> total.dur<span class="sc">$</span>total.dur.days[<span class="dv">5</span>]</span>
<span id="cb80-326"><a href="#cb80-326" aria-hidden="true" tabindex="-1"></a>                              </span>
<span id="cb80-327"><a href="#cb80-327" aria-hidden="true" tabindex="-1"></a>                              )</span>
<span id="cb80-328"><a href="#cb80-328" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-329"><a href="#cb80-329" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add class and RSI estimate to plot, then save plot</span></span>
<span id="cb80-330"><a href="#cb80-330" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">annotate_figure</span>(p, <span class="at">top =</span> class)</span>
<span id="cb80-331"><a href="#cb80-331" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-332"><a href="#cb80-332" aria-hidden="true" tabindex="-1"></a>  full.out <span class="ot">&lt;-</span> <span class="fu">rbind</span>(full.out, temp.full.out)</span>
<span id="cb80-333"><a href="#cb80-333" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-334"><a href="#cb80-334" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-335"><a href="#cb80-335" aria-hidden="true" tabindex="-1"></a> <span class="co">#Maps as jpeg for visualization</span></span>
<span id="cb80-336"><a href="#cb80-336" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggsave</span>(<span class="fu">paste0</span>(temp.name,<span class="st">".jpeg"</span>), p1, <span class="at">path =</span> <span class="st">"Maps"</span>, <span class="at">width =</span> <span class="dv">16</span>, <span class="at">height =</span> <span class="dv">8</span>, <span class="at">units =</span> <span class="st">"in"</span>, <span class="at">dpi =</span> <span class="dv">300</span>) </span>
<span id="cb80-337"><a href="#cb80-337" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggsave</span>(<span class="fu">paste0</span>(<span class="st">"Combo_"</span>,temp.name,<span class="st">".jpeg"</span>), p, <span class="at">path =</span> <span class="st">"Maps"</span>, <span class="at">width =</span> <span class="dv">16</span>, <span class="at">height =</span> <span class="dv">8</span>, <span class="at">units =</span> <span class="st">"in"</span>, <span class="at">dpi =</span> <span class="dv">300</span>) </span>
<span id="cb80-338"><a href="#cb80-338" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: `fortify(&lt;SpatialPolygonsDataFrame&gt;)` was deprecated in ggplot2 3.4.4.
 Please migrate to sf.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 7</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 8</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 9</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 10</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 11</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 12</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 13</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 14</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 15</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 16</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 17</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 18</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 19</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 20</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 21</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 22</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 23</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 24</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 25</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 26</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 27</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 28</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 29</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 30</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 31</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 32</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 33</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 34</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 35</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 36</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 37</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 38</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 39</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 40</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 41</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 42</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 43</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 44</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 45</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 46</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 47</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 48</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 49</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 50</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 51</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 52</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 53</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 54</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 55</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 56</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 57</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 58</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 59</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 60</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 61</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 62</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 63</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 64</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 65</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 66</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 67</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 68</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 69</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 70</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 71</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 72</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 73</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 74</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 75</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Show last plots made in For Loop to check if everything went correctly</span></span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Groves_Coy_Kmeans_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a>p1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Groves_Coy_Kmeans_files/figure-html/unnamed-chunk-7-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Save data output df as RDate &amp; csv</span></span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(full.out, <span class="at">file =</span> <span class="st">"Full_out.RDate"</span>)</span>
<span id="cb159-4"><a href="#cb159-4" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(full.out,<span class="at">file =</span> <span class="st">"Full_out.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="data-analysisexploration" class="level2">
<h2 class="anchored" data-anchor-id="data-analysisexploration">Data Analysis/Exploration</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Extracting each analysis' results into own data frame</span></span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-3"><a href="#cb160-3" aria-hidden="true" tabindex="-1"></a><span class="co"># UDOI overlap scores</span></span>
<span id="cb160-4"><a href="#cb160-4" aria-hidden="true" tabindex="-1"></a>overlap <span class="ot">&lt;-</span> full.out[, <span class="fu">c</span>(<span class="st">"id"</span>, <span class="fu">grep</span>(<span class="st">"^o"</span>, <span class="fu">names</span>(full.out), <span class="at">value =</span> <span class="cn">TRUE</span>))]</span>
<span id="cb160-5"><a href="#cb160-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-6"><a href="#cb160-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Distance between centroids</span></span>
<span id="cb160-7"><a href="#cb160-7" aria-hidden="true" tabindex="-1"></a>dist.center <span class="ot">&lt;-</span> full.out[, <span class="fu">c</span>(<span class="st">"id"</span>, <span class="fu">grep</span>(<span class="st">"^dc"</span>, <span class="fu">names</span>(full.out), <span class="at">value =</span> <span class="cn">TRUE</span>))]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Add column with mean UDOI score ingoring NA</span></span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true" tabindex="-1"></a>overlap<span class="sc">$</span>score.mean <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(overlap[, <span class="dv">2</span><span class="sc">:</span><span class="dv">10</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb161-4"><a href="#cb161-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-5"><a href="#cb161-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Add column with mean distance between centroids ingoring NA</span></span>
<span id="cb161-6"><a href="#cb161-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-7"><a href="#cb161-7" aria-hidden="true" tabindex="-1"></a>dist.center<span class="sc">$</span>dist.mean <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(dist.center[, <span class="dv">2</span><span class="sc">:</span><span class="dv">10</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb161-8"><a href="#cb161-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-9"><a href="#cb161-9" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(overlap)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             id        o.1_2        o.1_3 o.1_4        o.1_5        o.2_3
1 year1.B1035oe 0.0008055904 3.058251e-05     0 1.792135e-05 0.0026883728
2 year1.B1044be 0.0000000000           NA    NA           NA           NA
3 year1.B1064yw 0.0240015917 1.119935e-02    NA           NA 0.0000000000
4 year1.B1065yw 0.0000000000           NA    NA           NA           NA
5 year1.B1066yw 0.0010084116 1.278931e-02    NA           NA 0.0002795641
6 year1.B1068yw 0.0001496183           NA    NA           NA           NA
        o.2_4       o.2_5       o.3_4 o.3_5       o.4_5   score.mean
1 0.003904067 0.001347838 8.07822e-06     0 0.003226636 0.0009780500
2          NA          NA          NA    NA          NA 0.0000000000
3          NA          NA          NA    NA          NA 0.0117336472
4          NA          NA          NA    NA          NA 0.0000000000
5          NA          NA          NA    NA          NA 0.0046924293
6          NA          NA          NA    NA          NA 0.0001496183</code></pre>
</div>
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dist.center)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             id dc.km.1_2 dc.km.1_3 dc.km.1_4 dc.km.1_5 dc.km.2_3 dc.km.2_4
1 year1.B1035oe  3.562309  5.441191  6.242746  5.891664  3.641447  2.851313
2 year1.B1044be 55.500118        NA        NA        NA        NA        NA
3 year1.B1064yw  4.894801  4.069645        NA        NA  8.100907        NA
4 year1.B1065yw 59.661864        NA        NA        NA        NA        NA
5 year1.B1066yw  3.517048  2.665258        NA        NA  4.265446        NA
6 year1.B1068yw 11.883743        NA        NA        NA        NA        NA
  dc.km.2_5 dc.km.3_4 dc.km.3_5 dc.km.4_5 dist.mean
1  4.128371  5.292022  7.676155  3.345942  4.969691
2        NA        NA        NA        NA 55.500118
3        NA        NA        NA        NA  5.688451
4        NA        NA        NA        NA 59.661864
5        NA        NA        NA        NA  3.482584
6        NA        NA        NA        NA 11.883743</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="co">#UDOI scores</span></span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Select 10 individuals with ranges BELOW 35km (from pervous wAKDE) defined as res (resident)</span></span>
<span id="cb165-3"><a href="#cb165-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-4"><a href="#cb165-4" aria-hidden="true" tabindex="-1"></a>res.sub.overlap <span class="ot">&lt;-</span> overlap[overlap<span class="sc">$</span>id <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"year1.C2084gy"</span>, <span class="st">"year1.C2085gy"</span>, <span class="st">"year1.C2046oe"</span>, <span class="st">"year1.C2024we"</span>, <span class="st">"year1.C2071gn"</span>,<span class="st">"year2.C2148be"</span>, <span class="st">"year1.C1835gy"</span>, <span class="st">"year1.C2129pk"</span>, <span class="st">"year2.C2106yw"</span>, <span class="st">"year2.C1809gy"</span>), ]</span>
<span id="cb165-5"><a href="#cb165-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-6"><a href="#cb165-6" aria-hidden="true" tabindex="-1"></a>res.sub.overlap<span class="sc">$</span>state <span class="ot">&lt;-</span> <span class="st">"res"</span></span>
<span id="cb165-7"><a href="#cb165-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-8"><a href="#cb165-8" aria-hidden="true" tabindex="-1"></a><span class="co">#Select 10 individuals with ranges ABOVE 35km (from pervous wAKDE) defined as trans (transiant)</span></span>
<span id="cb165-9"><a href="#cb165-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-10"><a href="#cb165-10" aria-hidden="true" tabindex="-1"></a>trans.sub.overlap <span class="ot">&lt;-</span> overlap[overlap<span class="sc">$</span>id <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"year1.C1047be"</span>, <span class="st">"year1.C1042be"</span>, <span class="st">"year1.C1822gy"</span>, <span class="st">"year1.C2001we"</span>,<span class="st">"year2.C1833gy"</span>, <span class="st">"year2.C2003we"</span>, <span class="st">"year2.C2101yw"</span>, <span class="st">"year2.C1032oe"</span>, <span class="st">"year2.C2087gy"</span>, <span class="st">"year1.C2034we"</span>), ]</span>
<span id="cb165-11"><a href="#cb165-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-12"><a href="#cb165-12" aria-hidden="true" tabindex="-1"></a>trans.sub.overlap<span class="sc">$</span>state <span class="ot">&lt;-</span> <span class="st">"trans"</span></span>
<span id="cb165-13"><a href="#cb165-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-14"><a href="#cb165-14" aria-hidden="true" tabindex="-1"></a>sub.overlap <span class="ot">&lt;-</span> <span class="fu">rbind</span>(res.sub.overlap, trans.sub.overlap)</span>
<span id="cb165-15"><a href="#cb165-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-16"><a href="#cb165-16" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(sub.overlap)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              id       o.1_2       o.1_3       o.1_4 o.1_5        o.2_3 o.2_4
40 year1.C1835gy 0.006524847          NA          NA    NA           NA    NA
45 year1.C2024we 0.018039133          NA          NA    NA           NA    NA
48 year1.C2046oe 0.006120948 0.013046178 0.002158824    NA 0.0000000000     0
52 year1.C2071gn 0.005836451 0.002671491          NA    NA 0.0015675836    NA
53 year1.C2084gy 0.000000000 0.011349993          NA    NA 0.0003284188    NA
54 year1.C2085gy 0.000000000          NA          NA    NA           NA    NA
   o.2_5       o.3_4 o.3_5 o.4_5  score.mean state
40    NA          NA    NA    NA 0.006524847   res
45    NA          NA    NA    NA 0.018039133   res
48    NA 0.007426751    NA    NA 0.004792117   res
52    NA          NA    NA    NA 0.003358509   res
53    NA          NA    NA    NA 0.003892804   res
54    NA          NA    NA    NA 0.000000000   res</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Distance between centers </span></span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Select 10 individuals with ranges BELOW 35km (from pervous wAKDE) defined as res (resident)</span></span>
<span id="cb167-3"><a href="#cb167-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-4"><a href="#cb167-4" aria-hidden="true" tabindex="-1"></a>res.sub.dist.center <span class="ot">&lt;-</span> dist.center[dist.center<span class="sc">$</span>id <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"year1.C2084gy"</span>, <span class="st">"year1.C2085gy"</span>, <span class="st">"year1.C2046oe"</span>, <span class="st">"year1.C2024we"</span>, <span class="st">"year1.C2071gn"</span>,<span class="st">"year2.C2148be"</span>, <span class="st">"year1.C1835gy"</span>, <span class="st">"year1.C2129pk"</span>, <span class="st">"year2.C2106yw"</span>, <span class="st">"year2.C1809gy"</span>), ]</span>
<span id="cb167-5"><a href="#cb167-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-6"><a href="#cb167-6" aria-hidden="true" tabindex="-1"></a>res.sub.dist.center<span class="sc">$</span>state <span class="ot">&lt;-</span> <span class="st">"res"</span></span>
<span id="cb167-7"><a href="#cb167-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-8"><a href="#cb167-8" aria-hidden="true" tabindex="-1"></a><span class="co">#Select 10 individuals with ranges ABOVE 35km (from pervous wAKDE) defined as trans (transiant)</span></span>
<span id="cb167-9"><a href="#cb167-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-10"><a href="#cb167-10" aria-hidden="true" tabindex="-1"></a>trans.sub.dist.center <span class="ot">&lt;-</span> dist.center[dist.center<span class="sc">$</span>id <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"year1.C1047be"</span>, <span class="st">"year1.C1042be"</span>, <span class="st">"year1.C1822gy"</span>, <span class="st">"year1.C2001we"</span>,<span class="st">"year2.C1833gy"</span>, <span class="st">"year2.C2003we"</span>, <span class="st">"year2.C2101yw"</span>, <span class="st">"year2.C1032oe"</span>, <span class="st">"year2.C2087gy"</span>, <span class="st">"year1.C2034we"</span>), ]</span>
<span id="cb167-11"><a href="#cb167-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-12"><a href="#cb167-12" aria-hidden="true" tabindex="-1"></a>trans.sub.dist.center<span class="sc">$</span>state <span class="ot">&lt;-</span> <span class="st">"trans"</span></span>
<span id="cb167-13"><a href="#cb167-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-14"><a href="#cb167-14" aria-hidden="true" tabindex="-1"></a>sub.dist.center <span class="ot">&lt;-</span> <span class="fu">rbind</span>(res.sub.dist.center, trans.sub.dist.center)</span>
<span id="cb167-15"><a href="#cb167-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-16"><a href="#cb167-16" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(sub.dist.center)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              id dc.km.1_2 dc.km.1_3 dc.km.1_4 dc.km.1_5 dc.km.2_3 dc.km.2_4
40 year1.C1835gy 1.0986343        NA        NA        NA        NA        NA
45 year1.C2024we 1.4423291        NA        NA        NA        NA        NA
48 year1.C2046oe 0.9580709 1.0057893  1.268962        NA 1.7674675  1.374993
52 year1.C2071gn 0.8052188 0.8273459        NA        NA 0.9667984        NA
53 year1.C2084gy 4.2801306 1.5428490        NA        NA 2.7625484        NA
54 year1.C2085gy 7.4622843        NA        NA        NA        NA        NA
   dc.km.2_5 dc.km.3_4 dc.km.3_5 dc.km.4_5 dist.mean state
40        NA        NA        NA        NA 1.0986343   res
45        NA        NA        NA        NA 1.4423291   res
48        NA  1.050485        NA        NA 1.2376278   res
52        NA        NA        NA        NA 0.8664544   res
53        NA        NA        NA        NA 2.8618427   res
54        NA        NA        NA        NA 7.4622843   res</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="co">#T test between subsample res/trans mean UDOI scores</span></span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a>t.overlap <span class="ot">&lt;-</span> <span class="fu">t.test</span>(score.mean <span class="sc">~</span> state, <span class="at">data =</span> sub.overlap)</span>
<span id="cb169-3"><a href="#cb169-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-4"><a href="#cb169-4" aria-hidden="true" tabindex="-1"></a>t.overlap</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  score.mean by state
t = 3.6058, df = 9.2266, p-value = 0.00547
alternative hypothesis: true difference in means between group res and group trans is not equal to 0
95 percent confidence interval:
 0.002265246 0.009816997
sample estimates:
  mean in group res mean in group trans 
       0.0064957495        0.0004546279 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="co">#T test between subsample res/trans mean distance between centers </span></span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a>t.dist.center <span class="ot">&lt;-</span> <span class="fu">t.test</span>(dist.mean <span class="sc">~</span> state, <span class="at">data =</span> sub.dist.center)</span>
<span id="cb171-3"><a href="#cb171-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-4"><a href="#cb171-4" aria-hidden="true" tabindex="-1"></a>t.dist.center</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  dist.mean by state
t = -2.0057, df = 9.1851, p-value = 0.07522
alternative hypothesis: true difference in means between group res and group trans is not equal to 0
95 percent confidence interval:
 -26.418524   1.547264
sample estimates:
  mean in group res mean in group trans 
           2.073212           14.508842 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="co">#T test between subsample res/trans mean distance between centers with outliner removed</span></span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a>R.sub.dist.center <span class="ot">&lt;-</span> sub.dist.center <span class="sc">%&gt;%</span></span>
<span id="cb173-3"><a href="#cb173-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(id <span class="sc">!=</span> <span class="st">"year1.C2085gy"</span>)</span>
<span id="cb173-4"><a href="#cb173-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-5"><a href="#cb173-5" aria-hidden="true" tabindex="-1"></a>R.t.dist.center <span class="ot">&lt;-</span> <span class="fu">t.test</span>(dist.mean <span class="sc">~</span> state, <span class="at">data =</span> R.sub.dist.center)</span>
<span id="cb173-6"><a href="#cb173-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-7"><a href="#cb173-7" aria-hidden="true" tabindex="-1"></a>R.t.dist.center</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  dist.mean by state
t = -2.1119, df = 9.0195, p-value = 0.06381
alternative hypothesis: true difference in means between group res and group trans is not equal to 0
95 percent confidence interval:
 -26.9916472   0.9228156
sample estimates:
  mean in group res mean in group trans 
           1.474426           14.508842 </code></pre>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>